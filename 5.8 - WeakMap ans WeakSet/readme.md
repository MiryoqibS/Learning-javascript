# üß† –¢–µ–º–∞ 5.8 - WeakMap –∏ WeakSet

## –ß—Ç–æ —è —É–∑–Ω–∞–ª

–í —ç—Ç–æ–π —Ç–µ–º–µ —è —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è, —á—Ç–æ —Ç–∞–∫–æ–µ `WeakMap` –∏ `WeakSet`, —á–µ–º –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω—ã—Ö `Map` –∏ `Set`, –∏ –∫–æ–≥–¥–∞ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

---

## üóù WeakMap

**`WeakMap` ‚Äî —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–π –∫–ª—é—á–∞–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç—ã.**  
–ü—Ä–∏–º–∏—Ç–∏–≤—ã (—Å—Ç—Ä–æ–∫–∏, —á–∏—Å–ª–∞ –∏ —Ç.–¥.) —Ç—É–¥–∞ –Ω–µ –ø–æ–π–¥—É—Ç ‚Äî –≤—ã–∫–∏–Ω–µ—Ç –æ—à–∏–±–∫—É.

–ü—Ä–∏–º–µ—Ä:

```javascript
let obj = {};
let weakMap = new WeakMap();
weakMap.set(obj, "–î–∞–Ω–Ω—ã–µ, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –æ–±—ä–µ–∫—Ç—É");
```

---

## –ú–µ—Ç–æ–¥—ã:

```javascript
weakMap.set(obj, value); //‚Äî –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫ –æ–±—ä–µ–∫—Ç—É

weakMap.get(obj); //‚Äî –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ

weakMap.has(obj); //‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞

weakMap.delete(obj); //‚Äî —É–¥–∞–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
```

–í–∞–∂–Ω–æ: `WeakMap` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–±–æ—Ä!
–¢–æ –µ—Å—Ç—å –Ω–µ–ª—å–∑—è –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –Ω–µ–º—É —á–µ—Ä–µ–∑ for...of, .keys(), .entries() –∏ —Ç.–ø.
–≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ...

---

## üì¶ –°–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞ (GC)

–ì–ª–∞–≤–Ω–∞—è —Ñ–∏—à–∫–∞ WeakMap: –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –±–æ–ª—å—à–µ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ–≥–æ —É–¥–∞–ª—è–µ—Ç, –≤–º–µ—Å—Ç–µ —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ WeakMap.
–≠—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ DOM-—ç–ª–µ–º–µ–Ω—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–æ–º —É–¥–∞–ª–∏—Ç—Å—è —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

## üîê WeakSet

WeakSet ‚Äî —ç—Ç–æ –ø–æ—á—Ç–∏ –∫–∞–∫ Set, –Ω–æ:

-—Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç—ã
-–Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–æ–≤
-—Ç–æ–∂–µ –Ω–µ –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç—Å—è
-—Ç–æ–∂–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å–±–æ—Ä—â–∏–∫—É –º—É—Å–æ—Ä–∞ –æ—á–∏—â–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—ä–µ–∫—Ç—ã

–ü—Ä–∏–º–µ—Ä:

```javascript
let visitedUsers = new WeakSet();
let user = { name: "John" };
visitedUsers.add(user);
visitedUsers.has(user); // true
user = null; // –æ–±—ä–µ–∫—Ç –∏—Å—á–µ–∑–∞–µ—Ç –∏ –∏–∑ –ø–∞–º—è—Ç–∏, –∏ –∏–∑ WeakSet
```

---

## –ú–µ—Ç–æ–¥—ã:

```javascript
.add(obj)

.has(obj)

.delete(obj)
```

---

## üí° –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ –æ–±—ä–µ–∫—Ç—É, –Ω–æ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—á–µ–∑–ª–∏, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω.

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –≤ –æ–±—ä–µ–∫—Ç–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∫–ª–∞—Å—Å–∞—Ö).

–í —Å–∏—Ç—É–∞—Ü–∏—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ–ª—å–∑—è –¥–æ–ø—É—Å—Ç–∏—Ç—å —É—Ç–µ—á–∫—É –ø–∞–º—è—Ç–∏.

---

## üßæ –ö—Ä–∞—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –°–≤–æ–π—Å—Ç–≤–æ         | Map / Set                 | WeakMap / WeakSet    |
| ---------------- | ------------------------- | -------------------- |
| –ö–ª—é—á–∏ / —ç–ª–µ–º–µ–Ω—Ç—ã | –ª—é–±—ã–µ (–≤–∫–ª—é—á–∞—è –ø—Ä–∏–º–∏—Ç–∏–≤—ã) | —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç—ã       |
| –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º–æ—Å—Ç—å   | ‚úÖ –î–∞                     | ‚ùå –ù–µ—Ç               |
| –†–∞–∑–º–µ—Ä `.size`   | ‚úÖ –î–∞                     | ‚ùå –ù–µ—Ç               |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GC     | ‚ùå –ù–µ—Ç                    | ‚úÖ –î–∞ (–∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ) |
